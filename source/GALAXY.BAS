100 SCREEN1,2,0:WIDTH32:COLOR15,1,1:KEYOFF:DEFINTA-Z:CLEAR400:DIMST$(4),SX(4),SV(4),C(6),D(192):R=RND(-TIME):GOSUB2000
110 HI=765:D(97)=1:D(98)=1:D(99)=1:D(104)=1:D(105)=1:D(106)=1:D(112)=1:D(113)=1:D(114)=1
120 X=88:Y=176:VX=0:VY=0:T=1:FU=1000:SC=0:LF=2:RD=1:GOSUB1000
150 ' ***** STAGE INIT *****
160 FORI=0TO4:A$="":S$=MID$("ahp",I\2+1,1):IFIMOD2=0THENSX(I)=0:SV(I)=1:S$=S$+MID$("biq",I\2+1,1)ELSESX(I)=25:SV(I)=-1:S$=MID$("cjr",I\2+1,1)+S$
170 FORJ=0TO12:IFINT(RND(1)*(3+I\2))=0THENA$=A$+S$ELSEA$=A$+"  "
180 NEXT:ST$(I)=A$+A$:NEXT
190 X=88:Y=176:VX=0:VY=0:T=1:FU=1000:GOSUB1100
200 ' ***** MAIN *****
210 Z=TIME:T=TMOD2+1
220 LOCATE0,5:PRINTMID$(ST$(0),SX(0)+1,25);
230 SX(0)=SX(0)+SV(0):IFSX(0)>25THENSX(0)=0
240 LOCATE0,8:PRINTMID$(ST$(1),SX(1)+1,25);
250 SX(1)=SX(1)+SV(1):IFSX(1)<0THENSX(1)=25
260 LOCATE0,11:PRINTMID$(ST$(2),SX(2)+1,25);
270 SX(2)=SX(2)+SV(2):IFSX(2)>25THENSX(2)=0
280 LOCATE0,14:PRINTMID$(ST$(3),SX(3)+1,25);
290 SX(3)=SX(3)+SV(3):IFSX(3)<0THENSX(3)=25
300 LOCATE0,17:PRINTMID$(ST$(4),SX(4)+1,25);
310 SX(4)=SX(4)+SV(4):IFSX(4)>25THENSX(4)=0
320 ON(STICK(0)+STICK(1))GOTO360,360,330,360,360,360,340,360:GOTO350
330 VX=VX+2:IFVX>8THENVX=8:GOTO350ELSE360
340 VX=VX-2:IFVX<-8THENVX=-8:GOTO350ELSE360
350 VX=VX+SGN(0-VX)*2
360 ON-(STRIG(0)+STRIG(1))GOTO370:GOTO380
370 IFVY>-8THENVY=VY-2:FU=FU-30
375 GOTO390あ
380 IFVY<0THENVY=VY+2
390 X=X+VX:Y=Y+VY
400 PUTSPRITE0,(X-4,Y),14,0:IFVYTHENPUTSPRITE1,(X-4,Y+T),C(T+4),1ELSEPUTSPRITE1,(-16,-16),0,1
410 A=&H1800+X\8+(y\8)*32:OND(VPEEK(A))+D(VPEEK(A+32))GOTO900
420 VPOKE&H2017,C(T):VPOKE&H2018,C(T+2)
430 FU=FU-2:IFFU<0THENFU=0
440 LOCATE28,13:PRINTUSING"####";FU;:IFFU=0GOTO900
450 LOCATE0,0:PRINTTIME-Z;:GOTO210
900 ' ***** MISS *****
910 PUTSPRITE0,(X-4,Y),6,2:PUTSPRITE1,(-16,-16),0,1
920 FORI=0TO1999:NEXT:IFLFTHENLF=LF-1:LOCATE26,20:PRINTUSING"LEFT #";LF;:GOTO190
950 ' ***** GAMEOVER *****
960 PUTSPRITE0,(-16,-16),0,0:LOCATE5,7:PRINT"G A M E O V E R":FORI=0TO2999:NEXT:END
1000 ' ***** SCREEN *****
1010 FORI=0TO23:LOCATE25,I:PRINT"ｱ";:NEXT
1020 LOCATE26,0:PRINT"ｲｲｲｲｲｲ";:LOCATE26,1:PRINT"GALAXY";:LOCATE26,2:PRINT" ZONE";:LOCATE26,3:PRINT"ｲｲｲｲｲｲ";
1030 LOCATE26,6:PRINT"TOP";:LOCATE26,9:PRINT"1UP";:LOCATE26,12:PRINT"FUEL";
1040 LOCATE26,20:PRINTUSING"LEFT #";LF;:LOCATE26,22:PRINTUSING"RD. ##";RD;
1050 FORI=0TO19:FORJ=1TO2:LOCATEINT(RND(1)*25),INT(RND(1)*24):PRINTMID$("ｸﾀ",J,1);:NEXT:NEXT
1060 RETURN
1100 ' ***** INFORMATION *****
1110 IFSC>HITHENHI=SC
1120 LOCATE26,7:PRINTUSING"#####0";HI;
1130 LOCATE26,10:PRINTUSING"#####0";SC;
1140 LOCATE28,13:PRINTUSING"####";FU;:RETURN
2000 ' ***** DATA SET *****
2010 READA$:IFA$<>"*"THENREADB$,C$:FORJ=0TO7:VPOKEASC(A$)*8+J,VAL("&H"+MID$(B$,J*2+1,2)):NEXT:VPOKE&H2000+ASC(A$)\8,VAL("&H"+C$):GOTO2010
2020 S=BASE(9)
2030 READR$:IFR$<>"*"THENVPOKES,VAL("&H"+R$):S=S+1:GOTO2030
2040 FORI=1TO6:READA$:C(I)=VAL("&H"+A$):NEXT
2050 RETURN
2100 ' ***** PCG DATA *****
2110 DATA a,3C7EEFBFEFDD6E3C,60,b,0000600070006000,60,c,000006000E000600,60
2120 DATA h,3C7EEFBFEFDD6E3C,D0,i,0000600070006000,D0,j,000006000E000600,D0
2130 DATA p,3C7EEFBFEFDD6E3C,70,q,0000600070006000,70,r,000006000E000600,70
2140 DATA ｱ,2424242424242424,40,ｸ,0000001000000000,40,ﾀ,0000000000000001,70
2150 DATA ｲ,0000FF00FF000000
2160 DATA *
2200 ' ***** SPRITE DATA *****
2210 DATA 01,01,03,03,06,07,02,03,07,06,0C,08,00,00,00,00
2220 DATA 00,00,80,80,C0,C0,80,80,C0,C0,60,20,00,00,00,00
2230 DATA 00,00,00,00,00,00,00,00,00,00,01,03,03,05,00,09
2240 DATA 00,00,00,00,00,00,00,00,00,00,00,80,80,40,00,20
2250 DATA 11,19,4F,0F,1F,1E,3B,FF,3F,1B,17,3A,21,41,00,00
2260 DATA 00,08,30,F0,61,BE,DC,B8,B0,D0,38,70,08,04,00,00
2270 DATA *
2280 ' ***** COLOR PATTERN *****
2290 DATA 40,70,70,40,09,06
